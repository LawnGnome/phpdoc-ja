<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision: 1.12 $ -->
 <reference id="ref.com">
  <title>Windows用のCOMサポート関数</title>
  <titleabbrev>COM</titleabbrev>

  <partintro> 
   <simpara>
    COMは、標準化された呼び出し規約及びコンポーネントが保存されている
    マシンや実行ファイルが存在するマシンの種類の実装の詳細をAPIの背後
    に隠蔽することにより、(あらゆる言語により)あらゆる言語で書かれたコー
    ドを再使用することを可能とする技術です。COMは、いくつかの基本的な
    オブジェクトルートを有する特別なRemote Procedure Call (RPC)機構と
    考えることができる。COMは、実装をインターフェイスから分離します。
   </simpara> 
   <simpara>
    COMは、バージョン管理、インターフェイスからの実装の分離、実行ファ
    イルの位置や記述される言語のような実装の詳細の隠蔽を推奨します。
   </simpara> 
   <simpara>
    COM関数は、PHPのWindowsバージョンでのみ利用可能です。
   </simpara> 
   <simpara>
    COMに関するより詳細な情報については、<ulink
    url="&url.comspecs;">COM規約</ulink>またはDon Boxの
    <ulink url="&url.yacl;"> Yet Another COM Library (YACL)</ulink>を
    参照下さい。
   </simpara> 
  </partintro> 
  
  <refentry id="class.com">
   <refnamediv>
    <refname>COM</refname>
    <refpurpose>COM class</refpurpose>
   </refnamediv>
   <refsynopsisdiv>
    <synopsis>$obj = new <classname>COM</classname>("server.object")</synopsis>
   </refsynopsisdiv>
   <refsect1 id="class.com.class">
    <title>説明</title>
    <simpara>
     COM クラスは、PHPスクリプトに統合された (D)COMコンポーネントのフ
     レームワークを提供します。
    </simpara>
   </refsect1>
   <refsect1 id="class.com.constructor">
    <title>メソッド</title>
     <methodsynopsis>
      <type>string</type><methodname>COM::COM</methodname>
      <methodparam><type>string</type><parameter>module_name</parameter></methodparam>
      <methodparam choice="opt"><type>string</type><parameter>server_name</parameter></methodparam>
      <methodparam choice="opt"><type>int</type><parameter>codepage</parameter></methodparam>
     </methodsynopsis>
    <para>
     COM クラスのコンストラクタ。 パラメータ:
     <variablelist>
      <varlistentry><term>module_name</term>
       <listitem>
	<simpara>
	 リクエストされたコンポーネントの名前またはクラスID。
	</simpara>
       </listitem>
      </varlistentry>
      <varlistentry><term>server_name</term>
       <listitem>
	<simpara>
	 コンポーネントを取得するDCOMサーバの名前。
	 &null;の場合には、
	 <literal>localhost</literal>が指定されたと仮定されます。
	 DCOMを使用するためには、<filename>php.ini</filename>で
	 <constant>com.allow_dcom</constant> を
	 &true;に設定してある必要があります。
	</simpara>
       </listitem>
      </varlistentry>
      <varlistentry><term>codepage</term>
       <listitem>
	<simpara>
	 PHPの文字列のUNICODE文字列への変換およびその逆変換で使用され
	 るコードページを指定します。使用可能な値は、
	 <constant>CP_ACP</constant>, <constant>CP_MACCP</constant>,
	 <constant>CP_OEMCP</constant>,
	 <constant>CP_SYMBOL</constant>,
	 <constant>CP_THREAD_ACP</constant>,
	 <constant>CP_UTF7</constant>, <constant>CP_UTF8</constant>で
	 す。
	</simpara>
       </listitem>
      </varlistentry>
     </variablelist>
    </para>
    <para>
     <example id="example.com1">
      <title>COM の例 (1)</title>
      <programlisting role="php">
<![CDATA[
// Wordを起動
$word = new COM("word.application") or die("Unable to instanciate Word");
print "Loaded Word, version {$word->Version}\n";

// 前面に表示
$word->Visible = 1;

// 空のドキュメントをオープン
$word->Documents->Add();

// 何か単純な作業をする
$word->Selection->TypeText("This is a test...");
$word->Documents[1]->SaveAs("Useless test.doc");

// Wordを閉じる
$word->Quit();

// オブジェクトを開放
$word->Release();
$word = null;
]]>
      </programlisting>
     </example>
    </para>
    <para>
     <example id="example.com2">
      <title>COM の例 (2)</title>
      <programlisting role="php">
<![CDATA[
$conn = new COM("ADODB.Connection") or die("Cannot start ADO");
$conn->Open("Provider=SQLOLEDB; Data Source=localhost;
Initial Catalog=database; User ID=user; Password=password");

$rs = $conn->Execute("SELECT * FROM sometable");    // Recordset

$num_columns = $rs->Fields->Count();
echo $num_columns . "\n";

for ($i=0; $i < $num_columns; $i++)
{
    $fld[$i] = $rs->Fields($i);
}

$rowcount = 0;
while (!$rs->EOF)
{
    for ($i=0; $i < $num_columns; $i++)
    {
        echo $fld[$i]->value . "\t";
    }
    echo "\n";
    $rowcount++;            // 行カウンタを増やす
    $rs->MoveNext();
}

$rs->Close();
$conn->Close();

$rs->Release();
$conn->Release();

$rs = null;
$conn = null;
]]>
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>
  
  <refentry id="class.variant">
   <refnamediv>
    <refname>VARIANT</refname>
    <refpurpose>VARIANT クラス</refpurpose>
   </refnamediv>
   <refsynopsisdiv>
    <synopsis>$vVar = new <classname>VARIANT</classname>($var)</synopsis>
   </refsynopsisdiv>
   <refsect1 id="class.variant.class">
    <title>説明</title>
    <simpara>
     VARIANT構造体に変数をラップするための簡単なコンテナクラス。
    </simpara>
   </refsect1>
   <refsect1 id="class.variant.constructor">
    <title>メソッド</title>
     <methodsynopsis>
      <type>string</type><methodname>VARIANT::VARIANT</methodname>
      <methodparam choice="opt"><type>mixed</type><parameter>value</parameter></methodparam>
      <methodparam choice="opt"><type>int</type><parameter>type</parameter></methodparam>
      <methodparam choice="opt"><type>int</type><parameter>codepage</parameter></methodparam>
     </methodsynopsis>
    <para>
     VARIANT クラスのコンストラクタ。 パラメータ:
     <variablelist>
      <varlistentry><term>value</term>
       <listitem>
	<simpara>
	 初期値。省略した場合には、VT_EMPTYオブジェクトが作成されます。
	</simpara>
       </listitem>
      </varlistentry>
      <varlistentry><term>type</term>
       <listitem>
	<simpara>
	 VARIANTオブジェクトのcontent型を指定します。使用可能な値は、
	 <constant>VT_UI1</constant>, <constant>VT_UI2</constant>,
	 <constant>VT_UI4</constant>, <constant>VT_I1</constant>,
	 <constant>VT_I2</constant>, <constant>VT_I4</constant>, 
	 <constant>VT_R4</constant>, <constant>VT_R8</constant>,
	 <constant>VT_INT</constant>, <constant>VT_UINT</constant>,
	 <constant>VT_BOOL</constant>, <constant>VT_ERROR</constant>,
	 <constant>VT_CY</constant>,  <constant>VT_DATE</constant>,
	 <constant>VT_BSTR</constant>,
	 <constant>VT_DECIMAL</constant>, 
	 <constant>VT_UNKNOWN</constant>,
	 <constant>VT_DISPATCH</constant>,
	 <constant>VT_VARIANT</constant>です。これらの値は相互に排他的
	 ですが、値があることを指定するために
	 <constant>VT_BYREF</constant>を組み合わせることが可能です。
	 省略された場合には、<parameter>value</parameter> の型が使用さ
	 れます。その他の情報については、MSDNライブラリを参照下さい。
	</simpara>
       </listitem>
      </varlistentry>
      <varlistentry><term>codepage</term>
       <listitem>
	<simpara>
	 PHPの文字列のUNICODE文字列への変換およびその逆変換で使用され
	 るコードページを指定します。使用可能な値は、
	 <constant>CP_ACP</constant>, <constant>CP_MACCP</constant>,
	 <constant>CP_OEMCP</constant>,
	 <constant>CP_SYMBOL</constant>,
	 <constant>CP_THREAD_ACP</constant>,
	 <constant>CP_UTF7</constant>, <constant>CP_UTF8</constant>で
	 す。
	</simpara>
       </listitem>
      </varlistentry>
     </variablelist>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.com-load">
   <refnamediv>
    <refname>com_load</refname>
    <refpurpose>
     COMコンポーネントへの新規リファレンスを作成する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>string</type><methodname>com_load</methodname>
      <methodparam><type>string</type><parameter>module name</parameter></methodparam>
      <methodparam><type>string</type><parameter>
	<replaceable><optional>server name</optional></replaceable>
       </parameter></methodparam>
      <methodparam choice="opt"><type>int</type><parameter>
	codepage
       </parameter></methodparam>
     </methodsynopsis>
    <para>
     <function>com_load</function>は、新規のCOMコンポーネントを作成し、
     このコンポーネントへのリファレンスを返します。失敗した場合に
     &false;を返します。
     Possible values for <parameter>codepage</parameter> are
     <constant>CP_ACP</constant>, <constant>CP_MACCP</constant>,
     <constant>CP_OEMCP</constant>, <constant>CP_SYMBOL</constant>,
     <constant>CP_THREAD_ACP</constant>, <constant>CP_UTF7</constant>
     and <constant>CP_UTF8</constant>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.com-invoke">
   <refnamediv>
    <refname>com_invoke</refname>
    <refpurpose>
     COMコンポーネントのメソッドをコールします。
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>mixed</type><methodname>com_invoke</methodname>
      <methodparam><type>resource</type><parameter>com_object</parameter></methodparam>
      <methodparam><type>string</type><parameter>function_name</parameter></methodparam>
      <methodparam><type>mixed</type><parameter>
        <replaceable>
	 <optional>function parameters, ...</optional>
	</replaceable>
       </parameter></methodparam>
     </methodsynopsis>
    <para>
     <function>com_invoke</function>は、
     <parameter>com_object</parameter>が指すCOMコンポーネントのメソッ
     ドをコールします。エラーの場合に&false;を返し、
     成功時に<parameter>function_name</parameter>の返り値を返します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.com-propget">
   <refnamediv>
    <refname>com_propget</refname>
    <refpurpose>
     COMコンポーネントのプロパティの値を得る
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>mixed</type><methodname>com_propget</methodname>
      <methodparam><type>resource</type><parameter>com_object</parameter></methodparam>
      <methodparam><type>string</type><parameter>property</parameter></methodparam>
     </methodsynopsis>
    <para>
     この関数は、<function>com_get</function>へのエイリアスです。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.com-get">
   <refnamediv>
    <refname>com_get</refname>
    <refpurpose>
     COMコンポーネントのプロパティの値を得る
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>mixed</type><methodname>com_get</methodname>
      <methodparam><type>resource</type><parameter>com_object</parameter></methodparam>
      <methodparam><type>string</type><parameter>property</parameter></methodparam>
     </methodsynopsis>
    <para>
     <parameter>com_object</parameter>が指すCOMコンポーネントの
     <parameter>property</parameter>の値を返します。エラー時に
     &false;を返します。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.com-propput">
   <refnamediv>
    <refname>com_propput</refname>
    <refpurpose>
     COMコンポーネントのプロパティに値を代入する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>void</type><methodname>com_propput</methodname>
      <methodparam><type>resource</type><parameter>com_object</parameter></methodparam>
      <methodparam><type>string</type><parameter>property</parameter></methodparam>
      <methodparam><type>mixed</type><parameter>value</parameter></methodparam>
     </methodsynopsis>
    <para>
     この関数は、<function>com_set</function>へのエイリアスです。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.com-propset">
   <refnamediv>
    <refname>com_propset</refname>
    <refpurpose>
     COMコンポーネントのプロパティに値を代入する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>void</type><methodname>com_propset</methodname>
      <methodparam><type>resource</type><parameter>com_object</parameter></methodparam>
      <methodparam><type>string</type><parameter>property</parameter></methodparam>
      <methodparam><type>mixed</type><parameter>value</parameter></methodparam>
     </methodsynopsis>
    <para>
     この関数は、<function>com_set</function>へのエイリアスです。
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.com-set">
   <refnamediv>
    <refname>com_set</refname>
    <refpurpose>
     COMコンポーネントのプロパティに値を代入する
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>void</type><methodname>com_set</methodname>
      <methodparam><type>resource</type><parameter>com_object</parameter></methodparam>
      <methodparam><type>string</type><parameter>property</parameter></methodparam>
      <methodparam><type>mixed</type><parameter>value</parameter></methodparam>
     </methodsynopsis>
    <para>
     <parameter>com_object</parameter>が指すCOMコンポーネントの
     <parameter>property</parameter>の値を設定します。成功時に新規に設
     定された値、エラーの場合に&false;を返します。
    </para>
   </refsect1>
  </refentry>
  
  <refentry id="function.com-addref">
   <refnamediv>
    <refname>com_addref</refname>
    <refpurpose>
     コンポーネントリファレンスカウンタを増やす
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>void</type><methodname>com_addref</methodname>
      <void/>
     </methodsynopsis>
    <para>
     コンポーネントリファレンスカウンタを増やします。
    </para>
   </refsect1>
  </refentry>
  
  <refentry id="function.com-release">
   <refnamediv>
    <refname>com_release</refname>
    <refpurpose>
     コンポーネントリファレンスカウンタを減らす
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>void</type><methodname>com_release</methodname>
      <void/>
     </methodsynopsis>
    <para>
     コンポーネントリファレンスカウンタを減らします。
    </para>
   </refsect1>
  </refentry>

  <refentry id='function.com-isenum'>
   <refnamediv>
    <refname>com_isenum</refname>
    <refpurpose>IEnumVariantを取得する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>void</type><methodname>com_isenum</methodname>
      <methodparam><type>object</type><parameter>com_module</parameter></methodparam>
     </methodsynopsis>
    <para>
     &warn.undocumented.func;
    </para>
   </refsect1>
  </refentry>

  <refentry id='function.com-load-typelib'>
   <refnamediv>
    <refname>com_load_typelib</refname>
    <refpurpose>Typelibをロードする</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>void</type><methodname>com_load_typelib</methodname>
      <methodparam><type>string</type><parameter>typelib_name</parameter></methodparam>
      <methodparam choice="opt"><type>int</type><parameter>case_insensitive</parameter></methodparam>
     </methodsynopsis>
    <para>
     &warn.undocumented.func;
    </para>
   </refsect1>
  </refentry>

 </reference>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->

