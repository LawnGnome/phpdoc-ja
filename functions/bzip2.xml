 <reference id="ref.bzip2">
  <title>Bzip2 圧縮関数</title>
  <titleabbrev>Bzip2</titleabbrev>
  <partintro>
   <para>
    このモジュールは、Julian Seward により作成されたbzip2(.bz2)圧縮さ
    れたファイルを透過的に読み書きするための<ulink
    url="&url.bzip2;">bzip2</ulink>ライブラリの関数を使用しています。
   </para>
   <para>
    PHPにおけるbzip2サポートはデフォルトで有効になっていません。PHPで
    bzip2サポートを有効にするには、PHPのコンパイル時に設定オプションに
    <link linkend="install.configure.with-bzip2">--with-bz2</link>を使
    用する必要があります。このモジュールは、bzip2/libbzip2 version
    &gt;= 1.0.x を必要とします。
   </para>

   <sect1 id="bzip2-example">
    <title>簡単なコードの例</title>
    <para>
     この例は、テンポラリファイルをオープンし、テスト用の文字列を書き
     込みます。この後、このファイルの内容を出力します。
    </para>
    <example>
     <title>簡単な bzip2 の例</title>
     <programlisting role="php">
&lt;?php

$filename = "/tmp/testfile.bz2";
$str = "This is a test string.\n";

// 書き込み用にオープン
$bz = bzopen($filename, "w");

// ファイルに文字列を書き込む
bzwrite($bz, $str);

// ファイルを閉じる
bzclose($bz);

// 読み込み用にファイルをオープン
$bz = bzopen($filename, "r");

// 10文字読み込む
print bzread($bz, 10);

// ファイルの終端まで出力(または次の1024文字)し、閉じる
print bzread($bz);

bzclose($bz);

?>
     </programlisting>
    </example>
   </sect1>
  </partintro>


  <refentry id="function.bzclose">
   <refnamediv>
    <refname>bzclose</refname>
    <refpurpose>bzip2ファイルポインタを閉じる</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>bzclose</function></funcdef>
      <paramdef>int <parameter>bz</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     ポインタ<parameter>bz</parameter>で参照されるbzip2ファイルを閉じ
     ます。
    </para>
    <para>
     成功時にtrue、失敗時にfalseを返します。
    </para>
    <para>
     ファイルポインタは有効である必要があり、
     <function>bzopen</function>によりオープンされたファイルを指してい
     る必要があります。
    </para>
    <para>
     <function>bzopen</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>

  
  <refentry id="function.bzcompress">
   <refnamediv>
    <refname>bzcompress</refname>
    <refpurpose>文字列をbzip2形式のデータに圧縮する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>bzcompress</function></funcdef>
      <paramdef>string <parameter>source</parameter></paramdef>
      <paramdef>int
       <parameter><optional>blocksize</optional></parameter>
      </paramdef>
      <paramdef>int 
       <parameter><optional>workfactor</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     <function>bzcompress</function> は、文字列
     <parameter>source</parameter> を圧縮し、bzip2形式のデータとして返
     します。
    </para>
    <para>
     オプションのパラメータ<parameter>blocksize</parameter>は、圧縮時
     のブロック長を指定し、1から9の数とする必要があります。この場合、9
     の圧縮度が最大ですが、リソースの消費量も最大となります。
     <parameter>blocksize</parameter> は、デフォルトで4になっています。
    </para>
    <para>
     オプションのパラメータ<parameter>workfactor</parameter>は、 
     繰り返しが多い、最悪の入力データの場合の圧縮処理の動作を制御しま
     す。この値は、0から250までとなり、0は特別な場合、30はデフォルト値
     となります。<parameter>workfactor</parameter> によらず圧縮された
     データは同じになります。
    </para>
    <para>
     <example>
      <title><function>bzcompress</function> の例</title>
      <programlisting role="php">
$str = "sample data";
$bzstr = bzcompress($str, 9);
print $bzstr;
      </programlisting>
     </example>
    </para>
    <para>
     <function>bzdecompress</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>


  <refentry id="function.bzdecompress">
   <refnamediv>
    <refname>bzdecompress</refname>
    <refpurpose>bzip2形式のデータを解凍する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>bzdecompress</function></funcdef>
      <paramdef>string <parameter>source</parameter></paramdef>
      <paramdef>int
       <parameter><optional>small</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     <function>bzdecompress</function> は、bzip2形式のデータの文字列
     <parameter>source</parameter> を解凍し、返します。オプションのパ
     ラメータ<parameter>small</parameter> がtrueの場合、よりメモリの消
     費量が少ない(所要メモリは最大2300K程度まで少なくなります)別の圧縮
     アルゴリズムが使用されますが、速度は約半分になってしまいます。
     この機能に関する詳細については、<ulink url="&url.bzip2;">bzip2
     ドキュメント</ulink> を参照下さい。
    </para>
    <para>
     <example>
      <title><function>bzdecompress</function></title>
      <programlisting role="php">
$start_str = "This is not an honest face?";
$bzstr = bzcompress($start_str);

print "Compressed String: ";
print $bzstr;
print "\n&lt;br&gt;n";

$str = bzdecompress($bzstr);
print "Decompressed String: ";
print $str;
print "\n&lt;br&gt;n";
      </programlisting>
     </example>
    </para>
    <para>
     <function>bzcompress</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>


  <refentry id="function.bzerrno">
   <refnamediv>
    <refname>bzerrno</refname>
    <refpurpose>bzip2エラー番号を返す</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>bzerrno</function></funcdef>
      <paramdef>int <parameter>bz</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     ファイルポインタ<parameter>bz</parameter>から返されたbzip2エラー
     のエラー番号を返します。
    </para>
    <para>
     <function>bzerror</function> および <function>bzerrstr</function>
     も参照下さい。
    </para>
   </refsect1>
  </refentry>


  <refentry id="function.bzerror">
   <refnamediv>
    <refname>bzerror</refname>
    <refpurpose>bzip2エラー番号とエラー文字列を配列で返す</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>bzerror</function></funcdef>
      <paramdef>int <parameter>bz</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     ファイルポインタ<parameter>bz</parameter>から返されたbzip2エラー
     のエラー番号とエラー文字列を連想配列として返します。
    </para>
    <para>
     <example>
      <title><function>bzerror</function>の例</title>
      <programlisting role="php">
$error = bzerror($bz);

echo $error["errno"];
echo $error["errstr"];
      </programlisting>
     </example>
    </para>
    <para>
     <function>bzerrno</function> および <function>bzerrstr</function>
     も参照下さい。
    </para>
   </refsect1>
  </refentry>


  <refentry id="function.bzerrstr">
   <refnamediv>
    <refname>bzerrstr</refname>
    <refpurpose>bzip2エラー文字列を返す</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>bzerrstr</function></funcdef>
      <paramdef>int <parameter>bz</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     ファイルポインタ<parameter>bz</parameter>から返されたbzip2エラー
     のエラーの文字列を返します。
    </para>
    <para>
     <function>bzerrno</function> および<function>bzerror</function>も
     参照下さい。
    </para>
   </refsect1>
  </refentry>


  <refentry id="function.bzflush">
   <refnamediv>
    <refname>bzflush</refname>
    <refpurpose>
     全てのバッファリングされたデータを強制的に書き込む
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>bzflush</function></funcdef>
      <paramdef>int <parameter>bz</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     バッファリングされた全てのbzip2データを<parameter>bz</parameter>
     が指すファイルポインタに書き込みます。
    </para>
    <para>
     成功時のtrue、失敗した際にfalseを返します。
    </para>
    <para>
     <function>bzread</function> および <function>bzwrite</function>も
     参照下さい。
    </para>
   </refsect1>
  </refentry>


  <refentry id="function.bzopen">
   <refnamediv>
    <refname>bzopen</refname>
    <refpurpose>bzip2圧縮されたファイルをオープンする</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>bzopen</function></funcdef>
      <paramdef>string <parameter>filename</parameter></paramdef>
      <paramdef>string <parameter>mode</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     bzip2 (.bz2) ファイルを読み書き用にオープンします。
     <parameter>filename</parameter> は、オープンするファイルの名前で
     す。<parameter>mode</parameter> は、
     <function>fopen</function> 関数 (読み込みは`r'、書き込みは`w'、等)
     に似ています。
    </para>
    <para>
     オープンできなかった場合、この関数はfalseを返します。それ以外の場
     合は、新規にオープンされたファイルへのポインタが返されます。
    </para>
    <para>
     <example>
      <title><function>bzopen</function> の例</title>
      <programlisting role="php">
$bz = bzopen("/tmp/foo.bz2", "r");
$decompressed_file = bzread($bz, filesize("/tmp/foo.bz2"));
bzclose($bz);

print "The contents of /tmp/foo.bz2 are: ";
print "\n&lt;br&gt;n";
print $decompressed_file;
      </programlisting>
     </example>
    </para>
    <para>
     <function>bzclose</function>も参照下さい。
    </para>
   </refsect1>
  </refentry>


  <refentry id="function.bzread">
   <refnamediv>
    <refname>bzread</refname>
    <refpurpose>バイナリ対応のbzip2ファイル読み込み</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>bzread</function></funcdef>
      <paramdef>int <parameter>bz</parameter></paramdef>
      <paramdef>int 
       <parameter><optional>length</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     <function>bzread</function> は、<parameter>bz</parameter>が指す
     bzip2ファイルポインタから最大<parameter>length</parameter>バイト
     読み込みます。読み込みは、(圧縮前の状態で)
     <parameter>length</parameter>バイトが読み込まれたか、EOFに達した
     かのどちらか最初に来た方で終了します。オプションのパラメータ
     <parameter>length</parameter>が指定されない場合、
     <function>bzread</function>は一度に(圧縮前の状態で)1024バイト読み
     込みます。
    </para>
    <para>
     <example>
      <title><function>bzread</function> の例</title>
      <programlisting role="php">
$bz = bzopen("/tmp/foo.bz2", "r");
$str = bzread($bz, 2048);
print $str;
      </programlisting>
     </example>
    </para>
    <para>
     <function>bzwrite</function> と <function>bzopen</function>も参照
     下さい。
    </para>
   </refsect1>
  </refentry>


  <refentry id="function.bzwrite">
   <refnamediv>
    <refname>bzwrite</refname>
    <refpurpose>バイナリ対応のbzip2ファイルへの書き込み</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>bzwrite</function></funcdef>
      <paramdef>int <parameter>bz</parameter></paramdef>
      <paramdef>string <parameter>data</parameter></paramdef>
      <paramdef>int
       <parameter><optional>length</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     <function>bzwrite</function> は、文字列
     <parameter>data</parameter>の中身を
     <parameter>bz</parameter>が指すbzip2ファイルストリームに書き込み
     ます。オプションの引数<parameter>length</parameter>を指定した場合、
     (圧縮前の)lengthバイト分の書き込みが終ったか、文字列の終端に達し
     たかで書き込みは終了します。
    </para>
    <para>
     <example>
      <title><function>bzwrite</function> の例</title>
      <programlisting role="php">
$str = "uncompressed data";
$bz = bzopen("/tmp/foo.bz2", "w");
bzwrite($bz, $str, strlen($str));
bzclose($bz);
      </programlisting> 
     </example>
    </para>
    <para>
     <function>bzread</function>および<function>bzopen</function>も参
     照下さい。
    </para>
   </refsect1>
  </refentry>


 </reference>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
