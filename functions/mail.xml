<?xml version="1.0" encoding="utf-8"?>
 <reference id="ref.mail">
  <title>メール関数</title>
  <titleabbrev>Mail</titleabbrev>
  <partintro>
   <simpara>
    <function>mail</function>関数によりメールを送ることができます。
   </simpara>

   <variablelist>
    <title>Mail設定ディレクティブ</title>

    <varlistentry id="ini.smtp">
     <term>
      <parameter>SMTP</parameter>
      <type>string</type>
     </term>
     <listitem>
      <para>
       SMTPサーバのDNS名またはIPアドレス。Windows環境で動作するPHPは、
       <function>mail</function>巻数で送信するメールに関してこの設定値
       を使用します。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry id="ini.sendmail-from">
     <term>
      <parameter>sendmail_from</parameter>
      <type>string</type>
     </term>
     <listitem>
      <para>
       Windows環境でPHPから送信されるメールにおいて "From:" に使用する
       メールアドレスを指定します。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry id="ini.sendmail-path">
     <term>
      <parameter>sendmail_path</parameter>
      <type>string</type>
     </term>
     <listitem>
      <para>
       <command>sendmail</command> プログラムを探すパスを指定します。
       通常、<filename>/usr/sbin/sendmail</filename> または
       <filename>/usr/lib/sendmail</filename>です。
       <command>configure</command> は、このパスを探し、デフォルト値と
       して設定しますが、これで上手くいかない場合にはこのオプションで
       設定する必要があります。
      </para>
      <para>
       sendmailを使用していないシステムは、必要に応じてこのディレクティ
       ブに使用するメールシステムが提供するsendmailのラッパー/代替品を
       設定する必要があります。例えば、<ulink
       url="&url.qmail;">Qmail</ulink>ユーザは、通常、
       <filename>/var/qmail/bin/sendmail</filename>に設定します。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </partintro>

  <refentry id="function.mail">
   <refnamediv>
    <refname>mail</refname>
    <refpurpose>メールの送信</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>bool <function>mail</function></funcdef>
      <paramdef>string <parameter>to</parameter></paramdef>
      <paramdef>string <parameter>subject</parameter></paramdef>
      <paramdef>string <parameter>message</parameter></paramdef>
      <paramdef>string 
       <parameter>
	<replaceable><optional>additional_headers</optional></replaceable>
       </parameter>
      </paramdef>
      <paramdef>string 
       <parameter>
	<replaceable><optional>additional_parameters</optional></replaceable>
       </parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     <function>mail</function>は<parameter>message</parameter>で
     指定されたメッセージを<parameter>to</parameter>で指定された
     受信者に自動的にメールします。<parameter>to</parameter>の中の
     各アドレスをカンマで区切ることにより、複数の受信者を指定できます。
     添付書類付きのemailおよび特別なコンテンツ型のemailはこの関数で送
     信可能です。これは、MIMEエンコーディングにより可能です。詳細な
     情報については、
     <ulink url="http://www.zend.com/zend/spotlight/sendmimeemailpart1.php"
      >http://www.zend.com/zend/spotlight/sendmimeemailpart1.php</ulink> 
     または <ulink url="&url.rfc1896;">RFC 1896</ulink>を参照下さい。
    </simpara>
    <para>
     <function>mail</function> は、メール送信に成功した場合に &true; 、
     それ以外の場合に &false; を返します。
    </para>
    <para>
     <example>
      <title>メールを送信する</title>
      <programlisting role="php">
mail("joecool@example.com", "My Subject", "Line 1\nLine 2\nLine 3");
      </programlisting>
     </example>
    </para>
    <simpara>
     4番目の文字列が指定された場合、その文字列はヘッダの最後に挿入され
     ます。通常、これはヘッダを追加する際に使用されます。複数のヘッダ
     を追加する場合は、改行で区切ります。
    </simpara>
    <note>
     <para>
      複数のヘッダを区切る場合、<literal>\r\n</literal>を使用する必要
      があります。ただし、いくつかのUnix MTA(Mail transfer agents)では
      改行文字(<literal>\n</literal>)だけでも動作します。
      Win32システムでは、Cc: ヘッダは大文字小文字を区別し、
      <literal>Cc:</literal>と書く必要があります。Bcc:ヘッダはWin32シ
      ステムではサポートされていません。
     </para>
    </note>
    <para>
     <example>
      <title>追加ヘッダを付加してメールを送信する</title>
      <programlisting role="php">
mail("nobody@example.com", "the subject", $message,
     "From: webmaster@$SERVER_NAME\r\n"
    ."Reply-To: webmaster@$SERVER_NAME\r\n"
    ."X-Mailer: PHP/" . phpversion());
      </programlisting>
     </example>
    </para>
    <para>
     パラメータ<parameter>additional_parameters</parameter>は、追加の
     パラメータをメール送信プログラムに渡す際に使用可能です。
     メール送信プログラムは、設定オプション
     <literal>sendmail_path</literal>により設定されます。例えば、
     sendmailを使用する際にエンベロープのsenderアドレスを設定する際に
     使用することが可能です。この方法でエンベロープのsenderヘッダを設
     定する際、'X-Warning'ヘッダが付加されないようにWebサーバを実行し
     ているユーザをsendmail設定に追加しておく必要があるかもしれません。
     <example>
      <title>
       追加ヘッダ及び追加コマンドラインパラメータを指定してメールを送信
      </title>
      <programlisting role="php">
mail("nobody@example.com", "the subject", $message,
     "From: webmaster@$SERVER_NAME", "-fwebmaster@$SERVER_NAME");
      </programlisting>
     </example>
    </para>
    <note>
     <para>
      この5番目のパラメータは、PHP 4.0.5で追加されました。
     </para>
    </note>
    <para>
     複雑なemailメッセージを作成する際に簡単な文字列結合を使用すること
     も可能です。
     <example>
      <title>複雑なemailを送信する</title>
      <programlisting role="php">
/* 送信先 */
$to  = "Mary &lt;mary@example.com&gt;" . ", " ; // カンマで区切る
$to .= "Kelly &lt;kelly@example.com&gt;";

/* 題名 */
$subject = "Birthday Reminders for August";

/* メッセージ */
$message = '
&lt;html&gt;
&lt;head&gt;
 &lt;title&gt;Birthday Reminders for August&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;Here are the birthdays upcoming in August!&lt;/p&gt;
&lt;table&gt;
 &lt;tr&gt;
  &lt;th&gt;Person&lt;/th&gt;&lt;th&gt;Day&lt;/th&gt;&lt;th&gt;Month&lt;/th&gt;&lt;th&gt;Year&lt;/th&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
  &lt;td&gt;Joe&lt;/td&gt;&lt;td&gt;3rd&lt;/td&gt;&lt;td&gt;August&lt;/td&gt;&lt;td&gt;1970&lt;/td&gt;
  &lt;td&gt;Sally&lt;/td&gt;&lt;td&gt;17th&lt;/td&gt;&lt;td&gt;August&lt;/td&gt;&lt;td&gt;1973&lt;/td&gt;
 &lt;/tr&gt;
&lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;
';

/* HTMLメールを送信する場合、Content-typeヘッダを指定可能です。 */
$headers  = "MIME-Version: 1.0\r\n";
$headers .= "Content-type: text/html; charset=iso-8859-1\r\n";

/* 追加ヘッダ */
$headers .= "From: Birthday Reminder &lt;birthday@example.com&gt;\r\n";

$headers .= "Cc: birthdayarchive@example.com\r\n";
$headers .= "Bcc: birthdaycheck@example.com\r\n";

/* ここでメールを送信する */
mail($to, $subject, $message, $headers);
      </programlisting>
     </example>
    </para>
    <note>
     <para>
      <parameter>to</parameter>または<parameter>subject</parameter>に
      改行文字を含まないようにして下さい。さもないと、正常に動作しない
      可能性があります。
     </para>
    </note>
   </refsect1>
  </refentry>

  <refentry id="function.ezmlm-hash">
   <refnamediv>
    <refname>ezmlm_hash</refname>
    <refpurpose>EZMLMで必要なハッシュ値を計算する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>ezmlm_hash</function></funcdef>
      <paramdef>string <parameter>addr</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <simpara>
     <function>ezmlm_hash</function>は、EZMLMメイリングリストをMySQL
     データベースで管理する際に必要なハッシュ値を計算します。
    </simpara>
    <para>
     <example>
      <title>ハッシュ値を計算し、ユーザを登録する</title>
      <programlisting role="php">
$user = "joecool@example.com";
$hash = ezmlm_hash ($user);
$query = sprintf ("INSERT INTO sample VALUES (%s, '%s')", $hash, $user);
$db->query($query); // PHPLIB dbインターフェースを使用します
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>

 </reference>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
