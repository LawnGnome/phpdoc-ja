<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision: 1.1 $ -->
<!-- EN-Revision: 1.2 Maintainer: takagi Status: ready -->
<!-- CREDITS: hirokawa -->

<chapter xml:id="sesam.setup" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 &reftitle.setup;

 <!-- {{{ Requirements -->
 <section xml:id="sesam.requirements">
  &reftitle.required;
   <section xml:id="sesam.config-notes">
    <title>設定上の注意</title>
    <para>
     PHP SESAM インターフェイスは、スタンドアロン版をサポートしていません。
     Apache モジュール版として組み込まれた場合のみ動作します。Apache
     PHP モジュールにおいて、<link linkend="sesam.configuration">SESAM
     インターフェイス</link> は Apache 用 ディレクティブにより設定されます。
     <table>
      <title>SESAM 設定用ディレクティブ</title>
      <tgroup cols="2">
       <thead>
        <row>
         <entry>ディレクティブ</entry>
         <entry>意味</entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry><literal>php3_sesam_oml</literal></entry>
         <entry><para>
          ロード可能な SESAM ドライバモジュールが含まれる BS2000 PLAM
          ライブラリの名前です。SESAM 関数を使用するために必要です。
          </para>
          <para>
          例:
          <informalexample>
           <programlisting role="apache">
<![CDATA[
php3_sesam_oml $.SYSLNK.SESAM-SQL.030
]]>
           </programlisting>
          </informalexample>
         </para>
       </entry>
    </row>
    <row>
     <entry><literal>php3_sesam_configfile</literal></entry>
     <entry><para>
      SESAM アプリケーション設定ファイルの名前です。SESAM 関数を
      使用する際に必要です。
      </para>
       <para>
        例:
        <informalexample>
         <programlisting role="apache">
<![CDATA[
php3_sesam_configfile $SESAM.SESAM.CONF.AW
]]>
         </programlisting>
        </informalexample>
        通常、次のような設定が含まれます (SESAM リファレンス
        マニュアルを参照ください)。
        <informalexample>
         <programlisting role="bs2000">
<![CDATA[
CNF=B
NAM=K
NOTYPE
]]>
         </programlisting>
        </informalexample>
       </para>
     </entry>
    </row>
    <row>
     <entry><literal>php3_sesam_messagecatalog</literal></entry>
     <entry><para>
      SESAM メッセージカタログファイルの名前です。多くの場合、
      このディレクティブは不要です。SESAM メッセージファイルがシステムの
      BS2000 メッセージファイルテーブルにインストールされていない
      場合にのみ、このディレクティブを設定することが可能です。
     </para>
       <para>
        例:
        <informalexample>
         <programlisting role="apache">
<![CDATA[
php3_sesam_messagecatalog $.SYSMES.SESAM-SQL.030
]]>
         </programlisting>
        </informalexample>
       </para>
     </entry>
    </row>
       </tbody>
      </tgroup>
     </table>
    </para>
    <para>
     PHP/SESAM インターフェイスの設定に加えて、メインフレーム上の SESAM
     データベースサーバ自体を設定する必要があります。これは、
     次のようになります。
     <itemizedlist>
      <listitem>
       <simpara>
        SESAM データベースハンドラ (DBH) を開始
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        SESAM データベースハンドラを指定して、データベースに接続
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     PHP スクリプトとデータベースハンドラの間の接続を得るには、選択した
     SESAM 設定ファイルのパラメータ <literal>CNF</literal> および
     <literal>NAM</literal> が実行中のデータベースハンドラの ID に
     一致している必要があります。
    </para>
    <para>
     分散型データベースの場合、ホストおよびデータベース名を有する
     分配テーブルを指定して SESAM/SQL-DCN エージェントを開始する必要が
     あります。
    </para>
    <para>
     (POSIX サブシステムで実行されている) PHP と (POSIX サブシステムの外で
     実行されている) データベースハンドラの間の通信は、SQLSCI という名前の
     特別なドライバモジュールと通常メモリを使用するSESAM接続モジュールで
     実現されます。通常メモリアクセスのため、そして、PHP は Web
     サーバの静的部分であるため、ODBC、JDBC、UTM 経由のリモートアクセスは
     不要であり、データベースへのアクセスは非常に高速です。
    </para>
    <para>
     スモールスタブローダ (SESMOD) のみが PHP にリンクされており、SESAM
     接続モジュールは SESAM の OML PLAM ライブラリからロードされます。
     <link linkend="sesam.configuration">設定</link>の際、この PLAM
     ライブラリの名前と SESAM 設定ファイルを使用するためのファイルリンクを
     PHP に指定する必要があります (SESAM V3.0 において、SQLSCI は標準配布の
     SESAM ツールライブラリから入手可能です)。
    </para>
    <para>
     SQL コマンドにおけるシングルクオートのクオートは、(シングルクオートの
     前にバックスラッシュを付加するのではなく) シングルクオートを
     2 つ重ねて使用するため、SESAM インターフェイスを使用する全ての PHP
     スクリプトについて、PHP 設定ディレクティブで <link
      linkend="ini.magic-quotes-gpc"><literal>php3_magic_quotes_gpc</literal></link>
     および <link linkend="ini.magic-quotes-sybase">
     <literal>php3_magic_quotes_sybase</literal></link> を
     <literal>On</literal> にしておく方が賢明でしょう。
    </para>
   </section>
 
 </section>
 <!-- }}} -->

 <!-- {{{ Installation -->
 <section xml:id="sesam.installation">
  &reftitle.install;
  &no.install;
 </section>
 <!-- }}} -->

 <!-- {{{ Configuration -->
 &reference.sesam.ini;
 <!-- }}} -->

 <!-- {{{ Runtime -->
 <section xml:id="sesam.runtime">
  <title>実行時の考慮</title>
  <para>
   BS2000 モデルの制限のために、ドライバは、Apache サーバがその
   サーバの子プロセスをフォークした後にのみロード可能となります。
   これは、各子プロセスの最初の SESAM リクエストを若干遅くしますが、
   その後のアクセスへの応答は最高速度となります。
  </para>
  <para>
   SESAM 用のメッセージカタログを明示的に定義した場合、そのカタログは
   ドライバがロードされる度 (すなわち、最初の SESAM リクエスト時)
   にロードされます。BS2000 オペレーティングシステムはメッセージカタログの
   ロードに成功した後にメッセージを出力します。このメッセージは、
   Apache の error_log ファイルに送信されます。BS2000 は、現在
   このメッセージの出力を停止することができません。このため、
   ログを段々と埋めていきます。
  </para>
  <para>
   SESAM OML PLAM ライブラリと SESAM 設定ファイルは、Web サーバを
   実行しているユーザ ID から読み込み可能であることを確認してください。
   そうでない場合、サーバはドライバをロードすることができず、SESAM
   関数をコールすることができません。また、Apache サーバを実行している
   ユーザ ID にデータベースへのアクセスが許可されている必要があります。
   そうでない場合、SESAM データベースハンドラへの接続は失敗します。
  </para>
 </section>
 <!-- }}} -->


 <!-- {{{ Resources -->
 <section xml:id="sesam.resources">
  &reftitle.resources;
  &no.resource;
 </section>
 <!-- }}} -->

</chapter>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->

