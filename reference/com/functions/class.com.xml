<?xml version="1.0" encoding="utf-8"?>
<!-- splitted from ./ja/functions/com.xml, last change in rev 1.6 -->
<!-- last change to 'class.com' in en/ tree in rev 1.12 -->
  <refentry id="class.com">
   <refnamediv>
    <refname>COM</refname>
    <refpurpose>COM class</refpurpose>
   </refnamediv>
   <refsynopsisdiv>
    <synopsis>$obj = new <classname>COM</classname>("server.object")</synopsis>
   </refsynopsisdiv>
   <refsect1 id="class.com.class">
    <title>説明</title>
    <simpara>
     COM クラスは、PHPスクリプトに統合された (D)COMコンポーネントのフ
     レームワークを提供します。
    </simpara>
   </refsect1>
   <refsect1 id="class.com.constructor">
    <title>メソッド</title>
     <methodsynopsis>
      <type>string</type><methodname>COM::COM</methodname>
      <methodparam><type>string</type><parameter>module_name</parameter></methodparam>
      <methodparam choice="opt"><type>string</type><parameter>server_name</parameter></methodparam>
      <methodparam choice="opt"><type>int</type><parameter>codepage</parameter></methodparam>
     </methodsynopsis>
    <para>
     COM クラスのコンストラクタ。 パラメータ:
     <variablelist>
      <varlistentry><term>module_name</term>
       <listitem>
	<simpara>
	 リクエストされたコンポーネントの名前またはクラスID。
	</simpara>
       </listitem>
      </varlistentry>
      <varlistentry><term>server_name</term>
       <listitem>
	<simpara>
	 コンポーネントを取得するDCOMサーバの名前。
	 &null;の場合には、
	 <literal>localhost</literal>が指定されたと仮定されます。
	 DCOMを使用するためには、<filename>php.ini</filename>で
	 <constant>com.allow_dcom</constant> を
	 &true;に設定してある必要があります。
	</simpara>
       </listitem>
      </varlistentry>
      <varlistentry><term>codepage</term>
       <listitem>
	<simpara>
	 PHPの文字列のUNICODE文字列への変換およびその逆変換で使用され
	 るコードページを指定します。使用可能な値は、
	 <constant>CP_ACP</constant>, <constant>CP_MACCP</constant>,
	 <constant>CP_OEMCP</constant>,
	 <constant>CP_SYMBOL</constant>,
	 <constant>CP_THREAD_ACP</constant>,
	 <constant>CP_UTF7</constant>, <constant>CP_UTF8</constant>で
	 す。
	</simpara>
       </listitem>
      </varlistentry>
     </variablelist>
    </para>
    <para>
     <example id="example.com1">
      <title>COM の例 (1)</title>
      <programlisting role="php">
<![CDATA[
// Wordを起動
$word = new COM("word.application") or die("Unable to instanciate Word");
print "Loaded Word, version {$word->Version}\n";

// 前面に表示
$word->Visible = 1;

// 空のドキュメントをオープン
$word->Documents->Add();

// 何か単純な作業をする
$word->Selection->TypeText("This is a test...");
$word->Documents[1]->SaveAs("Useless test.doc");

// Wordを閉じる
$word->Quit();

// オブジェクトを開放
$word->Release();
$word = null;
]]>
      </programlisting>
     </example>
    </para>
    <para>
     <example id="example.com2">
      <title>COM の例 (2)</title>
      <programlisting role="php">
<![CDATA[
$conn = new COM("ADODB.Connection") or die("Cannot start ADO");
$conn->Open("Provider=SQLOLEDB; Data Source=localhost;
Initial Catalog=database; User ID=user; Password=password");

$rs = $conn->Execute("SELECT * FROM sometable");    // Recordset

$num_columns = $rs->Fields->Count();
echo $num_columns . "\n";

for ($i=0; $i < $num_columns; $i++)
{
    $fld[$i] = $rs->Fields($i);
}

$rowcount = 0;
while (!$rs->EOF)
{
    for ($i=0; $i < $num_columns; $i++)
    {
        echo $fld[$i]->value . "\t";
    }
    echo "\n";
    $rowcount++;            // 行カウンタを増やす
    $rs->MoveNext();
}

$rs->Close();
$conn->Close();

$rs->Release();
$conn->Release();

$rs = null;
$conn = null;
]]>
      </programlisting>
     </example>
    </para>
   </refsect1>
  </refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
