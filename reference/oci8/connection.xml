<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision: 1.3 $ -->
<!-- EN-Revision: 1.3 Maintainer: takagi Status: ready -->
<!-- CREDITS: hirokawa,shimooka -->
<chapter xml:id="oci8.connection" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>接続のハンドリング</title>
 <para>
  oci8 拡張モジュールは Oracle に接続するための 3
  つの異なる関数を提供しています。
  アプリケーションに最適な関数を使用するのはあなた次第です。
  また、このセクションにある情報は、
  インフォームド・チョイス (十分な説明を受けよく考えた上での選択)
  を行う助けになることを目的としています。
 </para>
 <para>
  Oracle サーバへの接続は、完了まで要する時間という点から見ると、
  かなりコストのかかる操作です。<function>oci_pconnect</function> 関数は、
  異なるスクリプトリクエスト間で接続の再利用が可能な
  持続的キャッシュを使用します。
  これは、PHP プロセス (もしくは Apache の子プロセス)
  毎の接続に関するオーバーヘッドを一度のみ負うということを意味しています。
 </para>
 <para>
  もしアプリケーションが信用された異なる Web ユーザー毎に
  Oracle に接続する場合、<function>oci_pconnect</function>
  による持続的キャッシュは、
  同時ユーザー数の増加と共に有効ではなくなるでしょう。
  これは、多くのアイドル状態の接続が維持されることが原因で、
  Oracle サーバ全体のパフォーマンスに不利な影響を与え始めるためです。
  もしアプリケーションがこの方法で構成されている場合、
  <link
   linkend="ini.oci8.max-persistent">oci8.max_persistent</link> や <link
   linkend="ini.oci8.persistent-timeout">oci8.persistent_timeout</link>
  (持続的接続のキャッシュサイズや生存期間の制御が可能になります)
  を使用してアプリケーションをチューニングする、もしくは代わりに
  <function>oci_connect</function> を使用することが推奨されます。
 </para>
 <para>
  <function>oci_connect</function> と <function>oci_pconnect</function>
  の両者とも接続キャッシュを使用します。もし、同一パラメータと共に
  <function>oci_connect</function> を複数回コールする場合、
  2 番目以降は既存の接続ハンドルを返します。<function>oci_connect</function>
  によって使用されるキャッシュは、スクリプト実行終了時、
  もしくは明示的に接続ハンドルを閉じた時にクリアされます。
  <function>oci_pconnect</function> も同様の動作をしますが、
  キャッシュは独立して維持され、リクエスト間で残存します。
 </para>
 <para>
  このキャッシュ機能は忘れてはならないほど重要です。
  それは、2 つのハンドルがトランザクション的に独立していない
  (実際には同じ接続なので、どのような種類の独立もありません)
  ためです。もしアプリケーションが 2
  つの別々でトランザクション的に独立した接続を必要とする場合、
  <function>oci_new_connect</function> を使用すべきです。
 </para>
 <para>
  <function>oci_new_connect</function> は、他の既存の接続が存在したとしても
  常に Oracle サーバへの新規接続を生成します。
  特にアプリケーションの最も負荷が高い部分など、
  高トラフィックな Web アプリケーションに対しては
  <function>oci_new_connect</function> の使用を避けてください。
 </para>
</chapter>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->

