<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision: 1.7 $ -->
<!-- EN-Revision: 1.28 -->
<!-- EN-Revision: 1.28 Maintainer: hirokawa Status: ready -->
  <refentry id="function.mail">
   <refnamediv>
    <refname>mail</refname>
    <refpurpose>メールの送信</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>bool</type><methodname>mail</methodname>
      <methodparam><type>string</type><parameter>to</parameter></methodparam>
      <methodparam><type>string</type><parameter>subject</parameter></methodparam>
      <methodparam><type>string</type><parameter>message</parameter></methodparam>
      <methodparam choice="opt"><type>string</type><parameter>additional_headers</parameter></methodparam>
      <methodparam choice="opt"><type>string</type><parameter>additional_parameters</parameter></methodparam>
     </methodsynopsis>
    <simpara>
     <function>mail</function>は<parameter>message</parameter>で
     指定されたメッセージを<parameter>to</parameter>で指定された
     受信者に自動的にメールします。<parameter>to</parameter>の中の
     各アドレスをカンマで区切ることにより、複数の受信者を指定できます。
     添付書類付きのemailおよび特別なコンテンツ型のemailはこの関数で送
     信可能です。これは、MIMEエンコーディングにより可能です。詳細な
     情報については、<ulink url="&url.email.mime.zend;">
     Zend article</ulink>または<ulink url="&url.pear.package;Mail_Mime">
     PEAR Mime Classes</ulink>を参照ください。
    </simpara>
     <simpara>
     以下のRFCも有用でしょう。
     <ulink url="&url.rfc;1896;">RFC 1896</ulink>,
     <ulink url="&url.rfc;2045;">RFC 2045</ulink>,
     <ulink url="&url.rfc;2046;">RFC 2046</ulink>,
     <ulink url="&url.rfc;2047;">RFC 2047</ulink>,
     <ulink url="&url.rfc;2048;">RFC 2048</ulink>,
     <ulink url="&url.rfc;2049;">RFC 2049</ulink>
    </simpara>
    <para>
     <function>mail</function> は、メールを配送エージェントに
     渡すことに成功した場合に &true; 、それ以外の場合に &false; を返します。
    </para>
    <warning>
     <para>
      <function>mail</function>のWindows版実装は、UNIX版実装とは
      多くの点で違います。
      第一に、メッセージの生成にローカルのバイナリは使用せず、
      ソケットを通じて直接操作するだけです。
      これは<literal>MTA</literal>がネットワークソケットをlistenしている
      必要があるということを意味します（ローカルホスト、リモートマシン
      どちらでもかまいません）。
      第二に、<literal>From:</literal>, <literal>Cc:</literal>,
      <literal>Bcc:</literal>, <literal>Date:</literal>のようなカスタムヘッダは
      <literal>MTA</literal>が初期段階で解釈するの
      <emphasis role="strong">ではなく</emphasis>、
      PHPによってパースされます。
      PHP &lt; 4.3 では <literal>Cc:</literal>
      （大文字小文字は区別されます）ヘッダ要素だけがサポートされていました。
      <literal>PHP</literal> &gt;= 4.3 では全てヘッダ要素をサポートし、
      もはやcase-sensitive（大文字小文字を区別する）ではありません。
     </para>
    </warning>
    <para>
     <example>
      <title>メールを送信する</title>
      <programlisting role="php">
<![CDATA[
<?php
mail("joecool@example.com", "My Subject", "Line 1\nLine 2\nLine 3");
?>
]]>
      </programlisting>
     </example>
    </para>
    <simpara>
     4番目の文字列が指定された場合、その文字列はヘッダの最後に挿入され
     ます。通常、これはヘッダを追加する際に使用されます。複数のヘッダ
     を追加する場合は、改行で区切ります。
    </simpara>
    <note>
     <para>
      複数のヘッダを区切る場合、<literal>\r\n</literal>を使用する必要
      があります。ただし、いくつかのUnix MTA(Mail transfer agents)では
      改行文字(<literal>\n</literal>)だけでも動作します。
      Win32システムでは、Cc: ヘッダは大文字小文字を区別し、
      <literal>Cc:</literal>と書く必要があります。
     </para>
    </note>
    <para>
     <example>
      <title>追加ヘッダを付加してメールを送信する</title>
      <programlisting role="php">
<![CDATA[
<?php
mail("nobody@example.com", "the subject", $message,
     "From: webmaster@{$_SERVER['SERVER_NAME']}\r\n" .
     "Reply-To: webmaster@{$_SERVER['SERVER_NAME']}\r\n" .
     "X-Mailer: PHP/" . phpversion());
?>
]]>
      </programlisting>
     </example>
    </para>
    <para>
     パラメータ<parameter>additional_parameters</parameter>は、追加の
     パラメータをメール送信プログラムに渡す際に使用可能です。
     メール送信プログラムは、設定オプション
     <literal>sendmail_path</literal>により設定されます。例えば、
     sendmailを使用する際に<literal>-f</literal>オプションを使って
     エンベロープのsenderアドレスを設定する際に
     使用できます。この方法でエンベロープのsenderヘッダを設
     定する際、'X-Warning'ヘッダが付加されないようにWebサーバを実行し
     ているユーザをsendmail設定に追加しておく必要があるかもしれません。
     <example>
      <title>
       追加ヘッダ及び追加コマンドラインパラメータを指定してメールを送信
      </title>
      <programlisting role="php">
<![CDATA[
<?php
mail("nobody@example.com", "the subject", $message,
     "From: webmaster@{$_SERVER['SERVER_NAME']}", "-fwebmaster@{$_SERVER['SERVER_NAME']}");
?>
]]>
      </programlisting>
     </example>
    </para>
    <note>
     <para>
      この5番目のパラメータは、PHP 4.0.5で追加されました。
      PHP4.2.3以降、<link linkend="ini.safe-mode">セーフモード</link>
      の場合このパラメータは無効です。もし使用しようとすると、
      <function>mail</function>はwarningメッセージを発行して &false; を返します。
     </para>
    </note>
    <para>
     複雑なemailメッセージを作成する際に簡単な文字列結合を使用すること
     も可能です。
     <example>
      <title>複雑なemailを送信する</title>
      <programlisting role="php">
<![CDATA[
/* 送信先 */
$to  = "Mary <mary@example.com>" . ", " ; // カンマで区切る
$to .= "Kelly <kelly@example.com>";

/* 題名 */
$subject = "Birthday Reminders for August";

/* メッセージ */
$message = '
<html>
<head>
 <title>Birthday Reminders for August</title>
</head>
<body>
<p>Here are the birthdays upcoming in August!</p>
<table>
 <tr>
  <th>Person</th><th>Day</th><th>Month</th><th>Year</th>
 </tr>
 <tr>
  <td>Joe</td><td>3rd</td><td>August</td><td>1970</td>
 </tr>
 <tr>
  <td>Sally</td><td>17th</td><td>August</td><td>1973</td>
 </tr>
</table>
</body>
</html>
';

/* HTMLメールを送信する場合、Content-typeヘッダを指定可能です。 */
$headers  = "MIME-Version: 1.0\r\n";
$headers .= "Content-type: text/html; charset=iso-8859-1\r\n";

/* 追加ヘッダ */
$headers .= "To: Mary <mary@example.com>, Kelly <kelly@example.com>\r\n";
$headers .= "From: Birthday Reminder <birthday@example.com>\r\n";
$headers .= "Cc: birthdayarchive@example.com\r\n";
$headers .= "Bcc: birthdaycheck@example.com\r\n";

/* ここでメールを送信する */
mail($to, $subject, $message, $headers);
]]>
      </programlisting>
     </example>
    </para>
    <note>
     <para>
      <parameter>to</parameter>または<parameter>subject</parameter>に
      改行文字を含まないようにしてください。さもないと、正常に動作しない
      可能性があります。
     </para>
    </note>
    <note>
     <para>
      <parameter>to</parameter>引数には
      &quot;Something &lt;someone@example.com&gt;&quot; の形式の
      メールアドレスを与えることはできません。
      MTA(特にWindows環境下の)と通信する際にmail関数はこれを適切にパースできません。
     </para>
    </note>
    <para>
     See also <function>imap_mail</function>.
    </para>
   </refsect1>
  </refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
