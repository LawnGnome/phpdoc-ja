<?xml version="1.0" encoding="utf-8"?>
<!-- splitted from ./ja/functions/http.xml, last change in rev 1.1 -->
<!-- last change to 'setcookie' in en/ tree in rev 1.2 -->
  <refentry id="function.setcookie">
   <refnamediv>
    <refname>setcookie</refname>
    <refpurpose>クッキーを送信する</refpurpose>
   </refnamediv>
   <refsect1>
    <title>説明</title>
     <methodsynopsis>
      <type>int</type><methodname>setcookie</methodname>
      <methodparam><type>string</type><parameter>name</parameter></methodparam>
      <methodparam><type>string</type><parameter>
	<replaceable><optional>value</optional></replaceable>
       </parameter></methodparam>
      <methodparam><type>int</type><parameter>
	<replaceable><optional>expire</optional></replaceable>
       </parameter></methodparam>
      <methodparam><type>string</type><parameter>
	<replaceable><optional>path</optional></replaceable>
       </parameter></methodparam>
      <methodparam><type>string</type><parameter>
	<replaceable><optional>domain</optional></replaceable>
       </parameter></methodparam>
      <methodparam><type>int</type><parameter>
	<replaceable><optional>secure</optional></replaceable>
       </parameter></methodparam>
     </methodsynopsis>
    <para>
     <function>setcookie</function> は、その他のヘッダ情報と共に
     送信するクッキーを定義します。<parameter>name</parameter>
     を除くすべての引数はオプションです。
     クッキーは他のヘッダーを送信する<emphasis>前に</emphasis>送信
     される必要があります。(これはクッキーの制約であってPHPの制約では
     ありません)この制約により<literal>&lt;html></literal>または
     <literal>&lt;head></literal>タグの前にこの関数をコールする
     必要があります。
    </para>
    <para>
     引数<parameter>name</parameter>以外の全ての引数はオプションです。
     name 引数のみが指定された場合、nameという名前のクッキーはリモート
     クライアントから削除されます。
     全ての引数に関して引数の指定をスキップするために空文字列
     (<emphasis>&quot;&quot;</emphasis>)とすることが可能です。
     <parameter>expire</parameter>および <parameter>secure</parameter> 引数
     は空文字列でスキップすることはできません。代わりにゼロ
     (<emphasis>0</emphasis>)を使用してください。
     <parameter>expire</parameter>引数は、
     <function>time</function> または <function>mktime</function> 関数により
     返されたUNIX標準時を現す整数です。
     <parameter>secure</parameter>は、クッキーがHTTPS接続によってのみ
     伝送されることを指定します。
    </para>
    <para>  
     陥りやすい失敗:
     <itemizedlist>
      <listitem>
       <simpara>
	クッキーはクッキーを有効にするためにページを再ロードするまで
	アクセスすることができません。
       </simpara>
      </listitem>
      <listitem>
       <simpara>
	クッキーは設定されたものと同じパラメータで削除する必要がありま
        す。
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <simpara>
     PHP 3において同じスクリプトで<function>setcookie</function>を複数
     回コールした場合、逆の順番で実行されます。他のクッキーを挿入する
     前にあるクッキーを削除しようとする場合、削除する前に挿入を行う必
     要があります。PHP 4では、<function>setcookie</function>を複数回コー
     ルした場合でもコールした順番で実行されます。
    </simpara>
    <para>
     クッキーを送信するいくつかの例を以下に示します。
     <example>
      <title><function>setcookie</function>による送信の例</title>
      <programlisting role="php">
<![CDATA[
setcookie ("TestCookie", "Test Value");
setcookie ("TestCookie", $value,time()+3600);  /* 1時間で期限切れ */
setcookie ("TestCookie", $value,time()+3600, "/~rasmus/", ".utoronto.ca", 1);
]]>
      </programlisting>
     </example>
    </para>
    <para>
     上記の例で送信したクッキーを削除する方法の例を以下に示します。
     <example>
      <title><function>setcookie</function>による削除の例</title>
      <programlisting role="php">
<![CDATA[
setcookie ("TestCookie");
// 有効期限を1時間前に設定する
setcookie ("TestCookie", "", time() - 3600);
setcookie ("TestCookie", "", time() - 3600, "/~rasmus/", ".utoronto.ca", 1);
]]>
      </programlisting>
     </example>
     クッキーを削除する場合には、ブラウザの削除機構を起動するために必
     ず有効期限を過去に設定する必要があります。
    </para>
    <para>
     クッキーのvalueの部分は、クッキーの送信を行う際に自動的に
     URLエンコードされ、またクッキーを受信した際は、自動的にデコード
     されてクッキー名と同じ名前の変数に格納されることに注意して下さい。
     すなわち、スクリプト内部でTestCookieの内容を見たい場合は、以下
     の例のうちの一つを使用して下さい。
     <informalexample>
      <programlisting role="php">
<![CDATA[
echo $TestCookie;
echo $HTTP_COOKIE_VARS["TestCookie"];
]]>
      </programlisting>
     </informalexample>
    </para>
    <para>
     クッキー名で配列を記述することにより、クッキーの配列を設定するこ
     とも可能です。これにより配列要素と同数のクッキーを設定されますが、
     クッキーがスクリプトに受信された際に、値はクッキー名を有する配列
     に置きかえられます。
     <informalexample>
      <programlisting role="php">
<![CDATA[
setcookie ("cookie[three]", "cookiethree");
setcookie ("cookie[two]", "cookietwo");
setcookie ("cookie[one]", "cookieone");
if (isset ($cookie)) {
    while (list ($name, $value) = each ($cookie)) {
        echo "$name == $value<br>\n";
    } 
}
]]>
      </programlisting>
     </informalexample>
    </para>
    <para>
    クッキーに関する詳細は、<ulink url="&spec.cookies;">&spec.cookies;
    </ulink> にあるNetscapeのクッキーに関する仕様をご覧ください。
    </para>
    <simpara>
     サービスパック1を適用したMicrosoftインターネットエクスプローラ4 
     は、パスに関するパラメータを設定したクッキーを正確に処理することが
     できません。
    </simpara>
    <simpara>
     Netscape Communicator 4.05およびMicrosoft Internet Explorer 3.x
     は、pathとtime が設定されていない場合、クッキーを正確に処理する
     ことができないようです。
    </simpara>
   </refsect1>
  </refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
