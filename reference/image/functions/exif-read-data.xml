<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision: 1.2 $ -->
<!-- sync: 1.15 -->
<refentry id="function.exif-read-data">
 <refnamediv>
  <refname>exif_read_data</refname>
  <refpurpose>
   <acronym>JPEG</acronym>または<acronym>TIFF</acronym>から
   <acronym>EXIF</acronym>ヘッダを読みこむ
  </refpurpose>
 </refnamediv>
 <refsect1>
  <title>説明</title>
  <methodsynopsis>
   <type>array</type><methodname>exif_read_data</methodname>
   <methodparam><type>string</type><parameter>filename</parameter></methodparam>
   <methodparam choice="opt"><type>string</type><parameter>sections</parameter></methodparam>
   <methodparam choice="opt"><type>bool</type><parameter>arrays</parameter></methodparam>
   <methodparam choice="opt"><type>bool</type><parameter>thumbnail</parameter></methodparam>
  </methodsynopsis>
  <para>
   関数<function>exif_read_data</function>はJPEGまたはTIFFイメージファ
   イルからEXIFヘッダを読みこみます。この関数は、キーがヘッダ名、値
   がヘッダに関連するの値となる連想配列を返します。返すデータがない
   場合、&false;が返されます。
  </para>
  <para>
   <parameter>filename</parameter>は読みこむファイル名です。ここに
   URLを使用することはできません。
  </para>
  <para>
   <parameter>sections</parameter>は、結果の配列を生成する際に含める
   カンマ区切りのセクションのリストです。もしも要求されるセクションを
   見つけられない場合は &false; が返されます。
   <informaltable>
    <tgroup cols="2">
     <tbody>
      <row>
       <entry>FILE</entry>
       <entry>FileName, FileSize, FileDateTime, SectionsFound</entry>
      </row>
      <row>
       <entry>COMPUTED</entry>
       <entry>html, Width, Height, IsColor 及び他の取得可能なもの
       </entry>
      </row>
      <row>
       <entry>ANY_TAG</entry>
       <entry>タグを有する全ての情報 例えば、IFD0, EXIF, ...</entry>
      </row>
      <row>
       <entry>IFD0</entry>
       <entry>IFD0の全てのタグ付きのデータ。通常のイメージファイルで
        は、これにはイメージサイズが含まれます。</entry>
      </row>
      <row>
       <entry>THUMBNAIL</entry>
       <entry>
        2番目のIFDがある場合にファイルにサムネイルが含まれている可能
        性があります。埋め込まれているサムネイルに関する全てのタグ付
        きの情報はこのセクションに保存されています。
       </entry>
      </row>
      <row>
       <entry>COMMENT</entry>
       <entry>JPEGイメージのコメントヘッダ。</entry>
      </row>
      <row>
       <entry>EXIF</entry>
       <entry>
        EXIFセクションは、IFD0のサブセクションです。このセクションに
        は、イメージに関するより詳細な情報が含まれています。これらの
        エントリの多くはデジタルカメラに関するものです。
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
  </para>
  <para>
   <parameter>arrays</parameter>は、各セクションを配列とするかどうか
   を指定します。セクション<emphasis>FILE</emphasis>、
   <emphasis>COMPUTED</emphasis>、<emphasis>THUMBNAIL</emphasis>は、
   常に配列となります。これは、これらのセクションに含まれる値の名前
   が他のセクションと衝突するためです。
  </para>
  <para>
   <parameter>thumbnail</parameter>は、サムネイルのタグ付きのデータ
   だけでなく、サムネイル本体を読みこむかどうかを指定します。
  </para>
  <note>
   <para>
    Exifヘッダはデジタルカメラにより生成されたJPEG/TIFFイメージで使
    用される傾向がありますが、残念なことに、各デジタルカメラメーカー
    は、個々のイメージに関するタグ付けの方法について異なった考えを持っ
    ており、特定のExifヘッダの存在を仮定することはできません。
   </para>
  </note>
  <para>
   <example>
    <title><function>exif_read_data</function>の例</title>
    <programlisting role="php">
<![CDATA[
<?php
echo "test1.jpg:<br />\n";
$exif = exif_read_data ('tests/test1.jpg','IFD0');
echo $exif===false ? "No header data found.<br />\n" : "Image contains headers<br />";
$exif = exif_read_data ('tests/test2.jpg',0,true);
echo "test2.jpg:<br />\n";
foreach($exif as $key=>$section) {
    foreach($section as $name=>$val) {
        echo "$key.$name: $val<br />\n";
    }
}?>
]]>
    </programlisting>
    <para>
     最初のコールは、失敗します。これは、イメージがヘッダ情報を有していないためです。
     <screen role="php">
<![CDATA[
test1.jpg:
No header data found.
test2.jpg:
FILE.FileName: test2.jpg
FILE.FileDateTime: 1017666176
FILE.FileSize: 1240
FILE.FileType: 2
FILE.SectionsFound: ANY_TAG, IFD0, THUMBNAIL, COMMENT
COMPUTED.html: width="1" height="1"
COMPUTED.Height: 1
COMPUTED.Width: 1
COMPUTED.IsColor: 1
COMPUTED.ByteOrderMotorola: 1
COMPUTED.UserComment: Exif test image.
COMPUTED.UserCommentEncoding: ASCII
COMPUTED.Copyright: Photo (c) M.Boerger, Edited by M.Boerger.
COMPUTED.Copyright.Photographer: Photo (c) M.Boerger
COMPUTED.Copyright.Editor: Edited by M.Boerger.
IFD0.Copyright: Photo (c) M.Boerger
IFD0.UserComment: ASCII
THUMBNAIL.JPEGInterchangeFormat: 134
THUMBNAIL.JPEGInterchangeFormatLength: 523
COMMENT.0: Comment #1.
COMMENT.1: Comment #2.
COMMENT.2: Comment #3end
THUMBNAIL.JPEGInterchangeFormat: 134
THUMBNAIL.Thumbnail.Height: 1
THUMBNAIL.Thumbnail.Height: 1
]]>
       </screen>
    </para>
   </example>
  </para>
  <note>
   <para>
    イメージに何らかのIFDOデータが含まれている場合、COMPUTEDにはエン
    トリByteOrderMotorolaが含まれます。このエントリは、バイトオーダ
    がリトルインディアン(インテル)の場合に0、ビッグインディアン(モト
    ローラ)の場合に1となります。これは、PHP 4.3で追加されました。
   </para>
   <para>
    ExifヘッダにCopyrightが含まれる場合、これには2つの値が含まれる可
    能性があります。これはExif 2.10の規約に沿っていないため、
    COMPUTEDセクションは、エントリ
    <emphasis>Copyright.Photographer</emphasis>および
    <emphasis>Copyright.Editor</emphasis> をともに返しますが、
    IFD0セクションには両方のエントリをNULL文字で分割した型式のバイト
    配列が含まれます。さもなくば、(Exifのデフォルト処理に基づき)デー
    タ型式に誤りがあるとして最初のエントリのみを返します。
    COMPUTEDには、エントリ<emphasis>Copyright</emphasis>も含まれます。
    これは、元のcopyright文字列またはphotoおよびeditor copyrightのカ
    ンマ区切りのリストとなります。
   </para>
  </note>
  <note>
   <para>
    UserCommentタグにはCopyrightタグと同様の問題があります。
    このタグには2つの値を保存する可能性があり、この場合、使用される
    エンコーディングが最初に、値自体が2番目にきます。この場合、IFDセ
    クションにはエンコーディングまたはバイト配列のみが含まれます。
    COMPUTEDセクションには、エントリ
    <emphasis>UserCommentEncoding</emphasis>と
    <emphasis>UserComment</emphasis>の両方を保存します。
    エントリ<emphasis>UserComment</emphasis>はどちらの場合でも取得可
    能です。このため、FD0セクションの値の識別に使用されます。
   </para>
   <para>
    ユーザコメントがUnicodeまたはJISエンコーディングを使用しており、
    モジュールmbstringが利用できる場合、このエンコーディングはexifの
    初期設定に基づき自動的に変更されます。この機能は、PHP 4.3で追加
    されました。
   </para>
  </note>
  <note>
   <para>
    Height と Width は、<function>getimagesize</function>と同じ方法
    で計算されます。このため、これらの値はヘッダの一部として返す際に
    使用するべきではありません。また、htmlは通常の
    <acronym>HTML</acronym>で使用されるheight/widthテキスト文字列です。
   </para>
  </note>
  <note>
   <para>
    PHP 4.3以降、この関数は配列を含む埋めこまれた
    <acronym>IFD</acronym>データを全て読むことが可能となっています。
    また、埋めこみのサムネイルの大きさもサブ配列
    <emphasis>THUMBNAIL</emphasis>に返されます。
    関数<function>exif_read_data</function>は<acronym>TIFF</acronym>
    型式のサムネイルを返すことが可能です。
    最後に返り値の(メモリリミットに達するまでではない)最大長はもはや
    ないことを追記しておきます。
   </para>
  </note>
  <note>
   <simpara>
    この関数は、<option role="configure">--enable-exif</option>を指
    定してPHP 4をコンパイルした場合のみ使用可能です。この機能と動作
    は、PHP 4.2で変更されています。これより以前のバージョンは非常に
    不安定です。
   </simpara>
   <simpara>
    PHP 4.3以降、<option
     role="configure">--enable-mbstring</option>を指定してPHP 4がコ
    ンパイルされている場合、ユーザコメントのエンコーディングは自動
       的に変換されます。
   </simpara>
   <simpara>
    この関数は、GDイメージライブラリを必要としません。
   </simpara>
   <simpara>
    <function>exif_thumbnail</function> および
    <function>getimagesize</function>も参照ください。
   </simpara>
  </note>
 </refsect1>
</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
