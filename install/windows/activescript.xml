<?xml version="1.0" encoding="UTF-8"?>
<!-- $Revision$ -->
<!-- EN-Revision: 297028 Maintainer: haruki Status: ready -->
   <sect1 xml:id="install.windows.activescript" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title>ActiveScript</title>
    <para>
     このセクションでは、ActiveScript で PHP を使用する場合について説明します。
    </para>
    <para>
     ActiveScript は Windows 独自の SAPI で、PHP スクリプトが
     Windows Script Host, ASP/ASP.NET,
     Windows Script Components や Microsoft Scriptlet control といった
     ActiveScript 互換ホストで実行可能になります。
    </para>
    <para>
     PHP 5.0.1 の時点で、ActiveScript サポートは <link
     xlink:href="&url.pecl;">PECL</link> リポジトリに移動されました。
     &pecl.windows.download;
    </para>
    <note>
     <para>
      まず始めに、<link linkend="install.windows.manual">マニュアルインストールの手順</link> 
      をお読みください。
     </para>
    </note>
    <para>
     PHP をインストールした後、ActiveScript 用の DLL (<filename>php5activescript.dll</filename>) 
     をダウンロードし、メイン PHP フォルダ (<filename>C:\php</filename> 等) へ置いてください。
    </para>
    <para>
     ファイルを設置できたら、システムに DLL を登録します。
     （スタートメニューから）コマンドプロンプトを開き、
     PHP のフォルダへ移動し（<literal>cd C:\php</literal> 等とする）、
     <literal>regsvr32 php5activescript.dll</literal> と打ち込むと
     DLL を登録できます。
    </para>
    <para>
     ActiveScript が動作しているかテストするには、<literal>test.wsf</literal>
     という名前（拡張子名が重要）で新しいファイルを作成し、
     以下のようにタイプしてください。
     <programlisting>
<![CDATA[
<job xml:id="test">
 
 <script language="PHPScript">
  $WScript->Echo("Hello World!");
 </script>
 
</job>
]]>
     </programlisting>
     保存した後、ファイルをダブルクリックして、ウインドウに
     「Hello World!」 と表示されたら、上手く動作しています。
    </para>
    <note>
     <para>
      PHP 4では、エンジンは「ActivePHP」と命名されました。
      したがって、PHP 4を使用している場合、「PHPScript」を上記の例における
      「ActivePHP」に取り替えるべきです。
     </para>
    </note>
    <note>
     <para>
      ActiveScript では、デフォルトの &php.ini; ファイルは使われません。
      代わって、ロードする .exe ファイルと同じフォルダが探されます。
      拡張モジュールを読み込みたい場合は、
      <filename>php-activescript.ini</filename> ファイルを作成し、当該フォルダに
      設置すると良いでしょう。
     </para>
    </note>
   </sect1>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
