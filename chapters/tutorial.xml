<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision: 1.3 $ -->
 <chapter id="tutorial">
  <title>簡易チュートリアル</title>

  <para>
   ここで、PHPの基礎の基礎について簡単なチュートリアルで説明したいと
   思います。ここでは、PHPはWebページを作成する機能だけを有している
   わけではありませんが、PHPで動的なWebページを作成することのみを
   扱います。詳細は、
   <link linkend="intro-whatcando">PHPでできること</link>と題する
   セクションを参照して下さい。
  </para>
  <para>
   PHPを使用できるWebページは、通常のHTMLページと全く同様に扱われ、
   通常のHTMLページを作成するのと同様の方法で編集することができます。
  </para>

  <sect1 id="tutorial.requirements">
   <title>必要なものは?</title>
   <para>
    本チュートリアルでは、使用するサーバでPHPが使用可能であり、
    <filename>.php</filename>で終わる全てのファイルがPHPで処理
    されることを仮定します。多くのサーバーでは、PHPファイルに
    関してこれがデフォルトの拡張子ですが、確実なのはサーバの
    管理者にきいてみることです。サーバがPHPをサポートする場合、
    何もする必要はありません。<filename>.php</filename> ファイルを
    作成し、Webディレクトリに置くだけで、サーバがこれを自動的に
    パースしてくれます。何もコンパイルする必要はなく、他のツール
    をインストールする必要もありません。PHPのファイルは、通常の
    HTMLファイルに、あなたが行なう全ての処理を実装した特殊なタグを
    追加したものと考えると良いでしょう。
   </para>
  </sect1>

  <sect1 id="tutorial.firstpage">
   <title>PHPを使用する初めてのページ</title>
   <para>
    以下の内容で<filename>hello.php</filename>という名前のファイルを
    Webサーバのルートディレクトリに作成して下さい。
   </para>
   <para>
    <example>
     <title>初めてのPHPスクリプト: <filename>hello.php</filename></title>
     <programlisting role="php">
<![CDATA[
<html>
 <head>
  <title>PHP Test</title>
 </head>
 <body>
 <?php echo "Hello World<p>"; ?>
 </body>
</html>
]]>
     </programlisting>
     <para>
      このスクリプトの出力は次のようになります。
      <screen role="html">
<![CDATA[
<html>
 <head>
  <title>PHP Test</title>
 </head>
 <body>
 Hello World<p>
 </body>
</html>
]]>
      </screen>
     </para>
    </example>
   </para>
   <para>
    これは、CGIスクリプトとは似ていないことに注意して下さい。
    このファイルは、実行ファイルとしたり、特別な扱いをする必要は
    ありません。このファイルは、多くの面白いことを可能にする特別なタグを
    利用できる通常のHTMLファイルと考えることができます。
   </para>
   <para>
    このプログラムは非常に簡単なので、実際には、このようなページを
    作成するためにPHPを使用する必要はありません。
    <literal>Hello World</literal> をPHPの<function>echo</function>命令に
    より出力しているだけです。
   </para>
   <para>
    この例を試した際に、何も出力されない場合、または、ダウンロード用の
    プロンプトが表示されるか、テキストとしてファイル全体が表示された場合、
    利用指定サーバでPHPが利用できない可能性があります。本マニュアルの
    <link linkend="installation">インストール</link> の章により
    PHPを利用できるようにするよう管理者にきいてみてください。
    PHPスクリプトをローカルに開発したい場合には、
    <ulink url="&url.php.downloads;">ダウンロード</ulink> のセクションを
    参照して下さい。任意のオペレーティングシステムでローカルに
    開発を行なうことができますが、適当なWebサーバもインストールう
    必要があります。
   </para>
   <para>
    この例の目的は、特殊なPHPタグ形式を示すことです。
    この例では、<literal>&lt;?php</literal> がPHPタグの開始を
    示しています。この後、PHP命令を置き、終了タグ<literal>?&gt;</literal>
    を記述することにより、PHPモードを抜けています。
    このように任意の場所でPHPモードを抜けてHTMLファイルに移ることができます。
   </para>
  </sect1>

  <sect1 id="tutorial.useful">
   <title>より実用的な例</title>
   <para>
    次により実用的なことをしてみましょう。ページを見ているユーザが使用
    しているブラウザの種類を確認してみます。これを行なうには、ブラウザが
    HTTPリクエストの一部として送信したuser agent文字列を調べます。
    この情報は、<link linkend="language.variables">変数</link>に
    保存されています。PHPでは、変数名は常にドル記号で始まります。
    今、使用する変数は、<varname>$_SERVER["HTTP_USER_AGENT"]</varname>
    です。
   </para>
   <note>
    <title>PHPのオートグローバルに関する注意</title>
    <para>
     <link linkend="reserved.variables.server">$_SERVER</link> は、
     Webサーバ関連情報を全て保持するPHPの特別な予約変数です。詳細は、
     <link linkend="language.variables.superglobals">オートグローバル</link>
     (スーパーグローバルとも呼ばれます) を参照して下さい。
     これらの特別な変数は、PHP 4.1.0で導入されました。これ以前は、
     <varname>$HTTP_SERVER_VARS</varname>のような古い配列
     <varname>$HTTP_*_VARS</varname>を代わりに使用していました。古い
     とはいえ、これらの変数はまだ存在しています。
    </para>
   </note>
   <para>
    この変数を表示するには、以下のようにします。
   </para>
   <para>
    <example>
    <title>Printing a variable (Array element)</title>
    <programlisting role="php">
<![CDATA[
<?php echo $_SERVER["HTTP_USER_AGENT"]; ?>
]]>
    </programlisting>
    <para>
      このスクリプトの出力例は以下のようになります。
     <screen role="html">
Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)
     </screen>
    </para>
   </example>
   </para>
   <para>
    PHPで利用可能な変数の<link linkend="language.types">型</link>
    には多くの種類があります。上の例では、
    <link linkend="language.types.array">配列</link> の要素を
    出力しています。配列は、非常に有用です。
   </para>
   <para>
    <varname>$_SERVER</varname> は、自動的にPHPで利用可能な
    変数の一つに過ぎません。マニュアルの
    <link linkend="reserved.variables">予約変数</link>のセクションで
    リストを参照することができます。また、以下のようなファイルを作成する
    ことにより、完全なリストを入手することができます。
   </para>
   <para>
    <example>
     <title><function>phpinfo</function>で定義済みの変数を全て表示する</title>
     <programlisting role="php">
<![CDATA[
<?php phpinfo(); ?>
]]>
     </programlisting>
    </example>
   </para>
   <para>
    ブラウザにこのファイルを読み込むと、利用可能な全ての変数のリストとともに
    PHPに関する全ての情報を参照することができます。
   </para>
   <para>
    PHPタグの中に複数のPHP命令を置くことができ、echo文以上のことを行なう
    コードブロックを作成することができます。
    例えば、インターネット・エクスプローラかどうかを調べたい場合は、
    以下のようにします。
   </para>
   <para>
    <example>
     <title>
      <link linkend="control-structures">制御構造</link> および
      <link linkend="functions">関数</link>の使用例
     </title>
     <programlisting role="php">
<![CDATA[
<?php
if (strstr($_SERVER["HTTP_USER_AGENT"], "MSIE")) {
	echo "あなたはInternet Explorerを使用しています<br />";
}
?>
]]>
     </programlisting>
     <para>
      このスクリプトの出力例は以下のようになります。
      <screen role="html">
<![CDATA[
あなたはInternet Explorerを使用しています<br />
]]>
      </screen>
     </para>
    </example>
   </para>
   <para>
    ここで、新しい概念をいくつか導入します。
    <link linkend="control-structures.if">if</link> 文を使用しています。
    C言語の基本構文を知っているとしたら、理解できると思います。
    C言語や上記の構文を使用する他の言語をあまり知らない場合には、
    PHPの入門書を手にとって最初の数章を読むか、このマニュアルの
    <link linkend="langref">言語リファレンス</link>の部分を読むべきです。
    <ulink url="&url.php.books;">&url.php.books;</ulink>でPHP関連の
    本のリストを参照することができます。
   </para>
   <para>
    二番目の新しい概念は、<function>strstr</function>関数のコールです。
    <function>strstr</function> はPHPに組み込まれた関数で、
    文字列の中である文字列を探します。この場合、
    <varname>$_SERVER["HTTP_USER_AGENT"]</varname>の中で
    <literal>"MSIE"</literal>を探しています。この文字列が見つかった場合、
    この関数は &true; を返し、見つからなかった場合には &false;を返します。
    この関数が&true;を返し、<link linkend="control-structures.if">if</link> 
    文が&true;と評価すると、その{波括弧}の中のコードが実行されます。
    そうでない場合は、実行されません。
    <link linkend="control-structures.if">if</link>, 
    <link linkend="control-structures.else">else</link> と
    <function>strtoupper</function> や <function>strlen</function>
    のような他の関数で、似たような例を作ってみてください。
    関連するマニュアルの各ページにも例がのっています。
   </para>
   <para>
    この例を少し発展させて、PHPブロックの中からでもPHPモードから出たり
    入ったりすることができることを以下に示します。
   </para>
   <para>
    <example>
     <title>HTMLおよびPHPモードの両方を混在させる</title>
     <programlisting role="php">
<![CDATA[
<?php
if (strstr($_SERVER["HTTP_USER_AGENT"], "MSIE")) {
?>
<h3>strstrがtrueを返しました</h3>
<center><b>あなたはInternet Explorerを使用しています</b></center>
<?php
} else {
?>
<h3>strstrがfalseを返しました</h3>
<center><b>あなたはInternet Explorerを使用していません</b></center>
<?php
}
?>
]]>
     </programlisting>
     <para>
      この例の出力は以下のようになります。
      <screen role="html">
<![CDATA[
<h3>strstrがtrueを返しました</h3>
<center><b>あなたはInternet Explorerを使用しています</b></center>
]]>
      </screen>
     </para>
    </example>
   </para>
   <para>
    何かを出力する際にPHPのecho文を使用する代わりに、PHPモードを抜けて、
    通常のHTMLを送信しています。ここで注意すべき重要で強力な点は、
    スクリプトの論理フローが損なわれないということです。
    <function>strstr</function> が &true; または &false;のどちらを
    返すか、言い換えると<literal>MSIE</literal> が見つかったかどうかに
    基づき、HTMLブロックだけが見る側に送信されることになります。
   </para>
  </sect1>

  <sect1 id="tutorial.forms">
   <title>フォームの処理</title>
   <para>
    PHPの最も強力な機能の一つは、HTMLフォームを処理する手段です。
    理解するべき重要な基本概念は、あるフォームの中の全てのフォーム要素
    は、自動的にPHPスクリプトで利用可能になるということです。
    詳細は、マニュアルのセクション<link linkend="language.variables.external">
     PHPの外部からくる変数</link> およびPHPでフォームを使用する例を参照
    してください。以下にHTMLフォームの例を示します。
   </para>
   <para>
    <example>
     <title>簡単なHTMLフォーム</title>
     <programlisting role="html">
<![CDATA[
<form action="action.php" method="POST">
 名前: <input type="text" name="name" />
 年齢: <input type="text" name="age" />
 <input type="submit">
</form>
]]>
     </programlisting>
    </example>
   </para>
   <para>
    このフォームに関して特別なところはありません。これは通常のHTML
    フォームで特殊なタグは全く使用していません。
    ユーザがこのフォームを記入し、投稿ボタンを押した時、
    <filename>action.php</filename> ページがコールされます。
    このファイルには、以下のようなコードを記述します。
   </para>
   <para>
    <example>
     <title>フォームからのデータを出力する</title>
     <programlisting role="php">
<![CDATA[
こんにちは、<?php echo $_POST["name"]; ?>さん。
あなたは、<?php echo $_POST["age"]; ?> 歳です。
]]>
     </programlisting>
     <para>
      このスクリプトの出力例は次のようになります。
      <screen role="html">
<![CDATA[
こんにちは、Joe さん。
あなたは、22 歳です。
]]>
      </screen>
     </para>
    </example>
   </para>
   <para>
    これら行なっていることは明らかです。他に行なっていることはありません。
    変数 <varname>$_POST["name"]</varname> と 
    <varname>$_POST["age"]</varname>はPHPにより自動的に設定されます。
    前の部分では、オートグローバル<varname>$_SERVER</varname>を使用しま
    したが、ここでは、全てのPOSTデータを保持するオートグローバル
    <link linkend="reserved.variables.post">$_POST</link>を導入しています。
    フォームの<emphasis>メソッド</emphasis>がPOSTであることに注意して下さい。
    <emphasis>GET</emphasis>メソッドを使用している場合、フォームの
    情報は代わりにオートグローバル<link linkend="reserved.variables.get">
     $_GET</link>に代入されます。リクエストデータの発信源に留意しない場合
    には、オートグローバル変数
    <link linkend="reserved.variables.request">$_REQUEST</link>を使用
    することもできます。この変数は、GET, POST, COOKIE, FILE
    の混ざったものが含まれます。
    <function>import_request_variables</function> 関数も参照して下さい。
   </para>
  </sect1>
  
  <sect1 id="tutorial.oldcode">
   <title>新しいバージョンのPHPで古いコードを使用する</title>
   <para>
    現在、PHPは有名なスクリプト言語まで成長しており、
    各自のスクリプトで再利用可能な多くのコードとして公開されている
    リソースが存在します。PHP言語の開発者の大部分は、過去のバージョン
    との互換製を保とうとしており、過去のバージョン用に書かれた
   スクリプトは(理想的には)より新しい バージョンのPHPで変更せずに
    動作するはずです。しかし、実際には、通常、いくつかの変更が
    必要となります。
   </para>
   <para>
    古いコードに影響を与える最近の重要な二つの変更点を以下に示します。
    <itemizedlist>
     <listitem>
      <simpara>
       <varname>$HTTP_*_VARS</varname>配列が過去のものとなったこと。
       (これは、関数またはメソッドの中で使用する際にグローバル変数として
       宣言を行なう必要がありました。)  以下の
       <link linkend="language.variables.superglobals">オートグローバル
        配列</link>がPHP 4.1.0で導入されました。これらを以下に示します。
       <varname>$_GET</varname>, <varname>$_POST</varname>, 
       <varname>$_COOKIE</varname>, <varname>$_SERVER</varname>, 
       <varname>$_ENV</varname>, <varname>$_REQUEST</varname>,
       <varname>$_SESSION</varname>.  
       従来の$HTTP_POST_VARSのような配列<varname>$HTTP_*_VARS</varname>
       もまだ存在し、PHP 3以来維持されています。
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       外部変数は、もはやデフォルトでグローバルスコープに登録されません。
       言い換えると、PHP<ulink url="&url.php.release4.2.0;">4.2.0</ulink>
       以降、PHPディレクティブ
       <link linkend="ini.register-globals">register_globals</link>は、
       &php.ini;においてデフォルトで<emphasis>off</emphasis>となっています。
       これらの値にアクセスする推奨される方法は、
       上記のオートグローバル配列を使用する方法です。
       古いスクリプトや本、チュートリアルはこのディレクティブに
       依存している可能性があります。このディレクティブがonの場合、
       例えば、URL <literal>http://www.example.com/foo.php?id=42</literal>
       から<varname>$id</varname>を使用することができます。
       on、offによらず<varname>$_GET['id']</varname>は利用可能です。
      </simpara>
     </listitem>
    </itemizedlist>
    これらの変更に関する詳細は、
    <link linkend="language.variables.predefined">定義済みの変数</link>
    のセクションおよびそこにあるリンクを参照して下さい。
   </para>
  </sect1>
  
  <sect1 id="tutorial.whatsnext">
   <title>次にするべきことは?</title>
   <para>
    ここで得た知識により、マニュアルのほとんどの部分と
    サンプルのアーカイブにある多くのスクリプトの例を理解できる
    ようになったはずです。他の例をWebサイトphp.netにあるリンク
    セクション<ulink url="&url.php.links;">&url.php.links;</ulink>で
    探すこともできます。
   </para>
  </sect1>
 </chapter>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->

